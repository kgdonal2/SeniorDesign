#include <Button.h>

int rainGaugePin = 22;
int count = 0;
double rain = 0;
double BUCKET_SIZE_MM = 0.2794;
int done = 0;

void setup()
{
  pinMode(rainGaugePin, INPUT);
  Serial.begin(9600);
}

double calculateRain(int count) {
  return count * BUCKET_SIZE_MM;
}

void loop()
{
  if (done <= 80) {
    if (digitalRead(rainGaugePin) == HIGH) {
      count = count + 1;
      delay(50); // Debounce delay
    }
  } else {
    rain = calculateRain(count);
    Serial.println(rain);
    count = 0;
    done = 0;
    delay(230);
  }
  done = done + 1;
  delay(10);
}
